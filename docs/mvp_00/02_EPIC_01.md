# Epic 1 — Project Skeleton & Tooling

## Scope & Goal
Set up the Lincona Python 3.11 project skeleton, tooling, and developer ergonomics so engineers can build the MVP features. Deliver a Poetry-managed package `lincona` with CLI entrypoint `lincona`, consistent formatting/lint/type/test gates, and documented workflows (venv-first) aligned with MVP_00 specification.

## Functional Analysis & Design
- Enable contributors to install and develop via Poetry with isolated virtual environments.
- Provide a consistent command surface (`Makefile` targets that shell into Poetry) for format, lint, typecheck, tests, and CI.
- Ensure code style consistency (Black/Ruff/isort line length 120) and typed codebase (mypy strict for `src/`, relaxed for `tests/`).
- Guarantee quality gates: pre-commit runs full suite (ruff, black, isort, mypy, pytest --cov with per-file ≥80%).
- Capture project metadata and dependencies (runtime and dev) in `pyproject.toml` plus locked `poetry.lock`.
- Document setup and workflows in `README.md`, including virtual environment guidance.

## Technical Analysis & Design
- **Packaging**: Poetry project targeting Python 3.11, package name `lincona`, console_script entrypoint `lincona`.
- **Layout**: `src/lincona/` for code, `tests/` for unit tests, `docs/` existing, optional `scripts/` for helpers, `Makefile` at repo root.
- **Dependencies (runtime)**: textual/rich (TUI), httpx (OpenAI), pydantic v2 (config models), attrs/dataclasses not required, typing-extensions, asyncio; prompt_toolkit excluded for MVP (can add later).
- **Dev dependencies**: black, ruff, isort, mypy, pytest, pytest-cov, pytest-asyncio, freezegun, types-* stubs as needed.
- **Style config**: Line length 120 shared by Black, Ruff, isort. Ruff rule set: standard strict (E/F/W/I plus safety sets like B, UP), no aggressive ALL. isort profile compatible with Black/line length.
- **Typing policy**: mypy strict for `src/` (disallow_any, disallow_untyped defs), relaxed for `tests/` (allow untyped defs/Any).
- **Testing policy**: pytest with asyncio support; coverage threshold ≥80% per source file (pytest-cov).
- **Hooks**: `.pre-commit-config.yaml` running Poetry-managed tools: black, ruff, isort, mypy, pytest --cov (per-file gate), end-of-file/trailing whitespace fixes.
- **Makefile**: targets (`format`, `lint`, `typecheck`, `test`, `ci`, `lock`, `pre-commit-install`) execute via `poetry run ...` to honor venv; `make install` for `poetry install --with dev`.
- **Docs**: README section for setup (`poetry install`, `poetry shell` or `poetry run`), Makefile usage, and pre-commit install instructions.
- **Artifacts**: commit `poetry.lock`; include `.gitignore` for venv, caches, coverage, .pytest_cache, etc.

## Architecture Notes
- Tooling architecture is file-based: `pyproject.toml` centralizes tool configs (Black/Ruff/isort/mypy/pytest); Makefile orchestrates commands; pre-commit enforces gates before commits.
- Source tree is import-clean (`src/` layout) to avoid accidental relative imports during tests; tests use `PYTHONPATH` via Poetry.
- CLI entrypoint `lincona` registered in `pyproject.toml` under `[tool.poetry.scripts]`.
- Config models built with Pydantic v2 to align with later epics (config & persistence); runtime dependencies chosen to support upcoming TUI and OpenAI client work.

## Implementation Steps (sequential checklist)
[x] Initialize Poetry project (`poetry init`) for Python 3.11, name `lincona`; add console_script `lincona`.  
[ ] Create base layout: `src/lincona/__init__.py`, placeholder module(s), `tests/` with example test, keep existing `docs/`.  
[ ] Add runtime dependencies (textual, rich if separate, httpx, pydantic>=2, typing-extensions, asyncio) and dev dependencies (black, ruff, isort, mypy, pytest, pytest-cov, pytest-asyncio, freezegun, types-* stubs).  
[ ] Configure `pyproject.toml` tool sections: Black/isort/Ruff line length 120; Ruff standard strict set; mypy strict for `src/`, relaxed overrides for `tests/`; pytest defaults with asyncio and coverage settings (per-file ≥80%).  
[ ] Generate `poetry.lock` and ensure tracked.  
[ ] Add `.gitignore` for venvs, `.venv`, `.mypy_cache`, `.ruff_cache`, `.pytest_cache`, `.coverage`, `htmlcov`, `__pycache__`, `.DS_Store`.  
[ ] Write `Makefile` targets using `poetry run`: `format`, `lint`, `typecheck`, `test`, `ci` (aggregate), `lock`, `pre-commit-install`, `install` (poetry install with dev).  
[ ] Create `.pre-commit-config.yaml` invoking Poetry-managed hooks: trailing-whitespace, end-of-file-fixer, black, isort, ruff, mypy, pytest --cov (per-file 80%).  
[ ] Add initial README sections: prerequisites (Python 3.11, Poetry), venv usage (`poetry env use`, `poetry shell` or `poetry run`), Makefile commands, pre-commit setup (`poetry run pre-commit install`).  
[ ] Sanity check: run `make ci` to verify format/lint/type/test pass on skeleton.  
[ ] Document completion by ticking Epic 1 in `01_PLAN.md` when done.
